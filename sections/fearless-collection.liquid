{% liquid
  assign section_id = 'fearless-collection-' | append: section.id
  assign bg_color = section.settings.background_color | default: '#3a0000'
  assign text_color = section.settings.text_color | default: '#f5f2ec'
%}
<section id="{{ section_id }}" class="fearless-collection" style="--fearless-bg: {{ bg_color }}; --fearless-text: {{ text_color }};">
  <div class="fearless-collection__inner page-width">
    <div class="fearless-collection__heading" data-reveal-item>
      {% if section.settings.eyebrow != blank %}
        <p class="fearless-collection__eyebrow">{{ section.settings.eyebrow }}</p>
      {% endif %}
      {% if section.settings.heading != blank %}
        <h2 class="fearless-collection__title">{{ section.settings.heading }}</h2>
      {% endif %}
      {% if section.settings.text != blank %}
        <div class="fearless-collection__description">{{ section.settings.text }}</div>
      {% endif %}
    </div>
    {% if section.blocks.size > 0 %}
      <div class="fearless-collection__grid">
        {% for block in section.blocks %}
          <article class="fearless-collection__card" data-reveal-item {{ block.shopify_attributes }}>
            {% if block.settings.image != blank %}
              <div class="fearless-collection__media">
                {{ block.settings.image | image_url: width: 900 | image_tag: loading: 'lazy', sizes: '(min-width: 1200px) 320px, (min-width: 750px) calc(33vw - 24px), 100vw', widths: '360,540,720,900' }}
              </div>
            {% endif %}
            <div class="fearless-collection__card-body">
              {% if block.settings.title != blank %}
                <h3 class="fearless-collection__card-title">{{ block.settings.title }}</h3>
              {% endif %}
              {% if block.settings.description != blank %}
                <p class="fearless-collection__card-text">{{ block.settings.description }}</p>
              {% endif %}
            </div>
          </article>
        {% endfor %}
      </div>
    {% endif %}
    {% if section.settings.button_label != blank %}
      <div class="fearless-collection__cta" data-reveal-item>
        <a class="fearless-collection__button button" {% if section.settings.button_link != blank %}href="{{ section.settings.button_link }}"{% endif %}>{{ section.settings.button_label }}</a>
      </div>
    {% endif %}
  </div>
</section>

{% style %}
  #{{ section_id }} {
    background: var(--fearless-bg);
    color: var(--fearless-text);
    padding: clamp(3rem, 6vw, 6rem) 0;
  }

  #{{ section_id }} .fearless-collection__inner {
    display: flex;
    flex-direction: column;
    gap: clamp(2rem, 4vw, 3.5rem);
    align-items: center;
    text-align: center;
  }

  #{{ section_id }} .fearless-collection__heading {
    max-width: 960px;
  }

  #{{ section_id }} .fearless-collection__eyebrow {
    letter-spacing: 0.25em;
    text-transform: uppercase;
    font-size: 0.85rem;
    margin-bottom: 0.5rem;
    color: color-mix(in srgb, var(--fearless-text) 80%, transparent);
  }

  #{{ section_id }} .fearless-collection__title {
    font-size: clamp(2.2rem, 6vw, 3.75rem);
    font-weight: 600;
    margin: 0 0 1rem;
    position: relative;
    display: inline-block;
    padding-bottom: 0.5rem;
  }

  #{{ section_id }} .fearless-collection__title::after {
    content: '';
    position: absolute;
    left: 0;
    bottom: 0;
    width: 100%;
    height: 3px;
    background: var(--fearless-text);
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.45s ease var(--reveal-delay, 0ms);
  }

  #{{ section_id }} .fearless-collection__description {
    font-size: 1.1rem;
    line-height: 1.7;
    color: color-mix(in srgb, var(--fearless-text) 85%, transparent);
  }

  #{{ section_id }} .fearless-collection__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: clamp(1rem, 3vw, 2.5rem);
    width: 100%;
  }

  #{{ section_id }} .fearless-collection__card {
    background: color-mix(in srgb, var(--fearless-text) 5%, transparent);
    border-radius: 1.5rem;
    padding: 1.5rem 1.5rem 2rem;
    text-align: left;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    box-shadow: 0 20px 50px rgba(0,0,0,0.25);
  }

  #{{ section_id }} .fearless-collection__media img {
    width: 100%;
    height: auto;
    border-radius: 1.25rem;
    object-fit: cover;
  }

  #{{ section_id }} .fearless-collection__card-title {
    font-size: 1.25rem;
    margin: 0 0 0.5rem;
  }

  #{{ section_id }} .fearless-collection__card-text {
    margin: 0;
    line-height: 1.6;
    color: color-mix(in srgb, var(--fearless-text) 85%, transparent);
  }

  #{{ section_id }} .fearless-collection__cta {
    width: 100%;
    display: flex;
    justify-content: center;
  }

  #{{ section_id }} .fearless-collection__button {
    background: transparent;
    border: 1px solid var(--fearless-text);
    color: var(--fearless-text);
    padding: 0.85rem 2.5rem;
    border-radius: 999px;
    transition: background 0.3s ease, color 0.3s ease;
  }

  #{{ section_id }} .fearless-collection__button:hover {
    background: var(--fearless-text);
    color: var(--fearless-bg);
  }

  #{{ section_id }} [data-reveal-item] {
    opacity: 0;
    transform: translateY(32px);
    transition: opacity 0.6s ease var(--reveal-delay, 0ms), transform 0.6s ease var(--reveal-delay, 0ms);
  }

  #{{ section_id }} [data-reveal-item].is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  #{{ section_id }} .fearless-collection__heading.is-visible .fearless-collection__title::after {
    transform: scaleX(1);
  }

  @media screen and (max-width: 749px) {
    #{{ section_id }} .fearless-collection__card {
      padding: 1.25rem;
      border-radius: 1rem;
    }
  }
{% endstyle %}

<script>
  (function() {
    const section = document.getElementById('{{ section_id }}');
    if (!section) return;
    const revealItems = section.querySelectorAll('[data-reveal-item]');
    if (!revealItems.length) return;

    if (!('IntersectionObserver' in window)) {
      revealItems.forEach((item) => item.classList.add('is-visible'));
      return;
    }

    const observer = new IntersectionObserver((entries, obs) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          obs.unobserve(entry.target);
        }
      });
    }, {
      threshold: 0.15
    });

    revealItems.forEach((item, index) => {
      item.style.setProperty('--reveal-delay', `${index * 80}ms`);
      observer.observe(item);
    });
  })();
</script>

{% schema %}
{
  "name": "Fearless collection spotlight",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Eyebrow",
      "default": "Limited drop"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Timeless Pieces for a Fearless Generation"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Description",
      "default": "<p>Defiant design honoring voices silenced yet never forgotten. Stand bold.</p>"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label",
      "default": "Explore the collection"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#400000"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#fef2e4"
    }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Spotlight card",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Wanted Hoodie"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Defiant design honoring voices silenced yet never forgotten. Stand bold. Wear resistance."
        }
      ]
    }
  ],
  "max_blocks": 5,
  "presets": [
    {
      "name": "Fearless collection spotlight",
      "blocks": [
        { "type": "feature" },
        { "type": "feature" },
        { "type": "feature" }
      ]
    }
  ]
}
{% endschema %}
